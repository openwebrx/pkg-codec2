From 786d70fa9165742282d0cbfb023a443950d950d4 Mon Sep 17 00:00:00 2001
From: Steve <coupaydeville@gmail.com>
Date: Mon, 8 Nov 2021 02:32:57 -0600
Subject: [PATCH 43/53] Update fsk_get_test_bits.c

Change from alloca() to malloc() for msys compatibility
---
 src/fsk_get_test_bits.c | 7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)

diff --git a/src/fsk_get_test_bits.c b/src/fsk_get_test_bits.c
index 163e4bdd..937ccf05 100644
--- a/src/fsk_get_test_bits.c
+++ b/src/fsk_get_test_bits.c
@@ -29,7 +29,6 @@
 
 #include <stdio.h>
 #include <stdlib.h>
-#include <alloca.h>
 #include <string.h>
 #include "fsk.h"
 
@@ -70,11 +69,11 @@ int main(int argc,char *argv[]){
     
     if(fout==NULL){
         fprintf(stderr,"Couldn't open output file: %s\n", argv[1]);
-        goto cleanup;
+        exit(1);
     }
     
     /* allocate buffers for processing */
-    bitbuf = (uint8_t*)alloca(sizeof(uint8_t)*framesize);
+    bitbuf = (uint8_t*)malloc(sizeof(uint8_t)*framesize);
     
     /* Generate buffer of test frame bits from known seed */
     srand(158324);
@@ -91,7 +90,7 @@ int main(int argc,char *argv[]){
 	}
     }
     
- cleanup:
+    free(bitbuf);
     fclose(fout);
 
     return 0;
-- 
2.30.2

