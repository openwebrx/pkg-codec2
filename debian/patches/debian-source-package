Description: The Debian source contains the lpcnet tar source,
 So this patch uses that feature and avoids fetching content.
Author: A. Maitland Bottoms <bottoms@debian.org>
Forwarded: not-needed

--- a/lpcnet/CMakeLists.txt
+++ b/lpcnet/CMakeLists.txt
@@ -79,7 +79,7 @@
 endif()
 
 # Set default flags
-set(CMAKE_C_FLAGS "-Wall -W -Wextra -Wno-unused-function -O3 -g -I. -MD ${CMAKE_C_FLAGS} -DENABLE_ASSERTIONS")
+set(CMAKE_C_FLAGS "-Wall -W -Wextra -Wno-unused-function -fPIC -O3 -g -I. -MD ${CMAKE_C_FLAGS} -DENABLE_ASSERTIONS")
 
 # Arch specific stuff here
 message(STATUS "Host system arch is: ${CMAKE_SYSTEM_PROCESSOR}")
@@ -139,6 +139,9 @@
     set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -mfpu=neon -march=armv8-a -mtune=cortex-a53")
 endif()
 
+if(LPCNET_191005_DIR)
+set(lpcnet_SOURCE_DIR ${LPCNET_191005_DIR})
+else()
 # grab latest NN model (or substitute your own)
 set(LPCNET_ROOT http://rowetel.com/downloads/deep/)
 set(LPCNET_FILE lpcnet_191005_v1.0.tgz)
@@ -170,6 +173,7 @@
         FetchContent_Populate(lpcnet)
     endif()
 endif()
+endif()
 
 # Find codec2
 if(CODEC2_BUILD_DIR)
--- a/lpcnet/src/CMakeLists.txt
+++ b/lpcnet/src/CMakeLists.txt
@@ -19,7 +19,7 @@
     ${lpcnet_SOURCE_DIR}/nnet_data.c
 )
 
-add_library(lpcnetfreedv SHARED ${lpcnet_freedv_srcs})
+add_library(lpcnetfreedv STATIC ${lpcnet_freedv_srcs})
 target_link_libraries(lpcnetfreedv codec2)
 set_target_properties(lpcnetfreedv PROPERTIES
     PUBLIC_HEADER lpcnet_freedv.h
